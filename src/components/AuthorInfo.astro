---
import { API_BASE_URL } from '../lib/apiConfig';
interface Props {
  authorId: string;
}

const { authorId} = Astro.props;

function cn(...classes: (string | undefined)[]) {
  return classes.filter(Boolean).join(' ');
}

function formatDate(dateString: string) {
  try {
    return new Date(dateString).toLocaleDateString('en-US', {
      year: 'numeric',
      month: 'short',
      day: 'numeric'
    });
  } catch {
    return 'Recently';
  }
}

// Fetch author information from the API
let author = null;
try {
  const response = await fetch(`${API_BASE_URL}/user_profiles/${authorId}`);
  if (response.ok) {
    author = await response.json();
  }
} catch (error) {
  console.error('Failed to fetch author information:', error);
}
---

<div class={cn("flex items-center space-x-2")}>
  <div class="flex items-center space-x-2">
    <span class="text-sm text-muted-foreground">
      {author ? 
        <p>{author.firstName} {author.lastName}{author.city ? ` â€¢ ${author.city}` : ''}</p> : 
        <p>Unknown author</p>
      }
    </span>
  </div>
</div>
